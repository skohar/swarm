machine:
  python:
    version: 2.7.10
  environment:
    PATH: "${HOME}/bin:${PATH}"
checkout:
  post:
    - git submodule sync
    - git submodule update --init
dependencies:
  cache_directories:
    - "~/bin"
  pre:
    - mkdir -p ~/bin
    - ./dependencies.sh
test:
  override:
    - source ami_name.sh && packer validate -var "AMI_NAME=`name`" packer.json
    - ./deploy.sh
deployment:
  production:
    branch: deployment/production
    commands:
      - ./deploy.sh
  staging:
    branch: master
    commands:
      - ./deploy.sh
